# 統計方法分析

除了上述的機器學習的分析方法，我們也嘗試了使用單純的統計方法來分析這個資料，以下是我們的分析流程。

## 分析流程

::: columns
::: {.column width="50%"}
1.  篩選變數

```{mermaid}
flowchart TD
  A[r個基因] --> C[r+t個基因和代謝體]
  B[t個代謝體] --> C
  C --> D["(r+t取2)個交互作用"]
  D --> E["(r+t+(r+t取2))選k個變數"]
```
:::

::: {.column width="50%"}
2.  建立模型

```{mermaid}
flowchart TD
  A[是否出現轉移] --> C[(Hurdle Model)]
  B[轉移到幾個部位] --> C
  C --> Criterion1[Evaluate by MSE]
  D[各個部位是否出現轉移] --> E[(5個logistic regression)]
  E --> Criterion2[Evaluate by AUC and Accuracy]
```
:::
:::

1.  關於篩選變數：

    在這份資料中，由於p\>n的問題，篩選變數是一個需要我們仔細思考的問題，另外，我們也從生物資訊相關文獻裡面知道了，除了個別基因和代謝體，基因和基因之間的交互作用，代謝體和代謝體之間的交互作用，基因和代謝體之間的交互作用都會影響反應變數，因此，如何有效的將上述三種交互作用放入模型中是我們考量的方向。 當然，我們可以將上述的三種交互作用一起放入模型中做篩選，但我們的變數個數本就很大了，再放進交互作用項顯然是一種不效率的做法。為了解決這個問題，我們發想了以下流程：

    1.  先從所有基因中篩選出r個最重要的基因
    2.  再從所有代謝體中篩選出t個最重要代謝體
    3.  接下來，我們只用(r+t)個基因和代謝體來看交互作用，共有$r+t \choose 2$ 個交互作用。
    4.  最後，從(r+t+$r+t \choose 2$)個變數中篩選出最重要的k個變數

2.  建模

    由這分資料的response，我們可以定義出下列三種反應變數：

    1.  反應變數為一個細胞是否轉移

    2.  反應變數為一個細胞轉移到幾個部位(Count Response)

    3.  反應變數為5個部位分別是否有轉移

    由於我們主要關心是第三種反應變數，前兩者我們會使用Hurdle model來配適模型，可以同時看出一些前兩者反應變數的資訊，這邊會使用。第三種反應變數，我們會使用logistic regression來配適模型，並且透過切割train test和AUC來驗證模型是否有效。
